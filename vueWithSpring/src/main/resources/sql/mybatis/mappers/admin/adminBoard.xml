<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="adminBoard">

	
	<sql id="whereInfo">
		WHERE 1=1
		<if test="region != null and region != ''">
		  AND A.BOARD_CONTENT LIKE CONCAT('%',#{boardContent},'%')
		</if>
		
	</sql>
	
	
	
	<insert id="mergeBestPlace" parameterType="map">
		INSERT INTO TB_BEST_PLACE
		 ( 
		 	<if test="userNum != null and userNum != ''">
			 USER_NUM,
	  		 </if>
			 <if test="plNum != null and plNum != ''">
			 PL_NUM,
	  		 </if>
	  		 <if test="plTitle != null and plTitle != ''">
			 PL_TITLE,
	  		 </if>
	  		 <if test="plContent != null and plContent != ''">
			 PL_CONTENT,
	  		 </if>
	  		 <if test="plCost != null and plCost != ''">
			  PL_COST,
	  		 </if>
	  		 <if test="plRegion != null and plRegion != ''">
			 PL_REGION,
	  		 </if>
			 PL_REG_DATE
		     )
		VALUES(
			<if test="userNum != null and userNum != ''">
			  #{userNum},
	  		 </if>
			<if test="plNum != null and plNum != ''">
			 #{plNum},
	  		 </if>
	  		 <if test="plTitle != null and plTitle != ''">
			 #{plTitle},
	  		 </if>
	  		 <if test="plContent != null and plContent != ''">
			 #{plContent},
	  		 </if>
	  		 <if test="plCost != null and plCost != ''">
			  #{plCost},
	  		 </if>
	  		 <if test="plRegion != null and plRegion != ''">
			 #{plRegion},
	  		 </if>
			 NOW()
		    )
		ON DUPLICATE KEY
		UPDATE   PL_TITLE = #{plTitle},
		 		 PL_CONTENT = #{plContent},
		 		 PL_COST = #{plCost},
		 		 PL_REGION = #{plRegion},
		 		 PL_REG_DATE = NOW()
	</insert>
	
	<select id="selectBoardList" parameterType="map" resultType="map">
	
		SELECT R.*
		FROM (SELECT 
					A.BOARD_NUM,
					A.BOARD_TITLE,
					A.USER_ID,
					A.BOARD_CONTENT,
					A.BOARD_UPD,
					A.BOARD_REG
				FROM TB_ADMIN_BOARD A
				
				<include refid="whereInfo" />
								
				) R 
		LIMIT #{cntPerPage} OFFSET #{startNum}
	</select>
	
	<select id="selectBoardListCount" parameterType="map" resultType="int">
				SELECT COUNT(*)
				FROM TB_ADMIN_BOARD A
			 <include refid="whereInfo" />
	</select>

</mapper>